/* ==UserStyle==
@name 「YouTube Black Edition」
@namespace BillyCool
@version 2.1.1
@description A pitch black userstyle for YouTube with a number of small tweaks and improvements.
@author BillyCool
@homepageURL https://github.com/BillyCool/UserStyles/tree/master/YouTube-Black-Edition
@updateURL https://github.com/BillyCool/UserStyles/raw/master/YouTube-Black-Edition/youtube-black-edition.user.css
@license GPL-3.0-or-later
@preprocessor stylus

@var color bg-1 "[Global] Background color" #000
@var range thumbnail-roundness "[Global] Thumbnail roundness" [12, 0, 16, 1, "px"]
@var range sub-grid-size "[Subscriptions] Grid size" [4, 4, 16, 1]
@var range sub-grid-margin "[Subscriptions] Grid margin" [8, 4, 32, 1, "px"]
@var checkbox sub-hide-avatar "[Subscriptions] Hide channel avatar" 0
@var checkbox sub-hide-most-relevant-shorts "[Subscriptions] Hide most relevant and short sections" 0
@var checkbox player-hide-prev-next "[Player] Hide previous and next buttons" 0
@var checkbox player-hide-merch "[Player] Hide merch shelf and links" 0
@var checkbox player-hide-join "[Player] Hide Join button" 0
@var checkbox player-hide-share "[Player] Hide Share button" 0
@var checkbox player-hide-save "[Player] Hide Save button" 0
@var checkbox player-hide-clip "[Player] Hide Clip button" 0
@var checkbox player-hide-three-dot "[Player] Hide 3-bot button" 0
@var checkbox player-hide-desc "[Player] Hide video description" 0
@var checkbox player-hide-desc-links "[Player] Hide external links in video description" 0
@var checkbox player-hide-desc-ai-summary "[Player] Hide AI summary in video description" 0
@var checkbox player-hide-desc-htwm "[Player] Hide how this was made in video description" 0
@var checkbox player-hide-desc-transcript "[Player] Hide transcript in video description" 0
@var checkbox player-hide-desc-chapters "[Player] Hide chapters in video description" 0
@var checkbox player-hide-desc-people "[Player] Hide people info in video description" 0
@var checkbox player-hide-desc-game "[Player] Hide game info in video description" 0
@var checkbox player-hide-desc-music "[Player] Hide music info in video description" 0
@var checkbox player-hide-desc-reels "[Player] Hide reels in video description" 0
@var checkbox player-hide-desc-info-cards "[Player] Hide info cards in video description" 0
@var checkbox player-hide-desc-info-card-channel "[Player] Hide info card channel in video description" 0
@var checkbox player-hide-desc-info-card-social "[Player] Hide info card social links in video description" 0
@var checkbox player-hide-desc-info-card-videos "[Player] Hide info card videos in video description" 0
@var checkbox comments-hide-links "[Comments] Hide comments with external links" 0
@var checkbox comments-hide-pinned "[Comments] Hide pinned comments" 0
@var checkbox comments-hide-translate "[Comments] Hide Translate button" 0
==/UserStyle== */

@-moz-document domain("youtube.com") {
    /* Variable declarations */
    bg-2 = lighten(bg-1, 5%);
    bg-3 = lighten(bg-1, 8%);
    bg-4 = lighten(bg-1, 12%);
    bg-5 = lighten(bg-1, 16%);
    
    html[dark], [dark] {
        --yt-spec-base-background: bg-1;
        --yt-spec-general-background-a: bg-3;
        --yt-spec-menu-background: bg-2;
        --yt-spec-mono-tonal-hover: bg-4;
        --yt-spec-badge-chip-background: bg-3;
        --yt-spec-button-chip-background-hover: bg-4;
        --yt-spec-additive-background: bg-3;
        --yt-spec-static-overlay-button-secondary: bg-4;
        --ytd-searchbox-background: bg-1;
        --ytd-searchbox-legacy-button-color: bg-3;
        --ytd-searchbox-legacy-button-hover-color: bg-4;
        --paper-tooltip-background: bg-4;
        --yt-spec-raised-background: bg-3;
    }
    
    ytd-masthead[frosted-glass] #background.ytd-masthead {
        background: var(--yt-spec-base-background);
    }

    #cinematics {
        display: none !important;
    }

    yt-thumbnail-view-model,
    #thumbnail,
    .ytp-ce-video.ytp-ce-large-round,
    .ytp-ce-playlist.ytp-ce-large-round,
    .ytp-ce-large-round .ytp-ce-expanding-overlay-background {
        border-radius: thumbnail-roundness !important;
    }
    
    ytd-browse[page-subtype="subscriptions"] ytd-two-column-browse-results-renderer #contents {
        ytd-rich-item-renderer {
            --ytd-rich-grid-items-per-row: sub-grid-size !important;
            --ytd-rich-grid-item-margin: sub-grid-margin !important;
            margin: 0 calc(var(--ytd-rich-grid-item-margin) / 2) 12px calc(var(--ytd-rich-grid-item-margin) / 2);

            if (sub-grid-size >= 10) {
                .yt-lockup-metadata-view-model__title {
                    font-size: "calc(1.6rem - (%s - 10) * 0.04rem)" % sub-grid-size;
                    line-height: "calc(2.2rem - (%s - 10) * 0.05rem)" % sub-grid-size;
                }
            }
        }
    }
    
    if (sub-hide-avatar) {
        #contents ytd-rich-item-renderer .yt-lockup-metadata-view-model__avatar {
            display: none;
        }
    }

    if (sub-hide-most-relevant-shorts) {
        #contents > ytd-rich-section-renderer:not(:first-child) {
            display: none !important;
        }
    }

    if (player-hide-prev-next) {
        .ytp-prev-button, .ytp-next-button {
            display: none !important;
        }
    }

    if (player-hide-merch) {
        ytd-merch-shelf-renderer,
        .ytp-featured-product-container,
        .ytp-suggested-action button[aria-label="View products"] {
            display: none !important;
        }
    }

    if (player-hide-join) {
        #sponsor-button {
            display: none !important;
        }
    }
    
    if (player-hide-share) {
        yt-button-view-model:has(button[aria-label="Share"]) {
            display: none !important;
        }
    }
    
    if (player-hide-save) {
        yt-button-view-model:has(button[aria-label="Save to playlist"]) {
            display: none !important;
        }
    }
    
    if (player-hide-clip) {
        yt-button-view-model:has(button[aria-label="Clip"]) {
            display: none !important;
        }
    }
    
    if (player-hide-three-dot) {
        yt-button-shape:has(button[aria-label="More actions"]) {
            display: none !important;
        }
    }

    #description-inline-expander {
        if (player-hide-desc) {
            #snippet, #expanded {
                display: none !important;
            }
        }
        else {
            if (player-hide-desc-links) {
                .yt-core-attributed-string--link-inherit-color > a:not([href^="/"]):not([href^="https://www.youtube.com"]) {
                    display: none !important;
                }
            }
        }

        if (player-hide-desc-htwm) {
            how-this-was-made-section-view-model {
                display: none !important;
            }
        }

        if (player-hide-desc-ai-summary) {
            #video-summary {
                display: none !important;
            }
        }

        if (player-hide-desc-transcript) {
            ytd-video-description-transcript-section-renderer {
                display: none !important;
            }
        }
    
        if (player-hide-desc-chapters) {
            ytd-horizontal-card-list-renderer[modern-chapters=""] {
                display: none !important;
            }
        }
    
        if (player-hide-desc-people) {
            yt-video-attributes-section-view-model {
                display: none !important;
            }
        }
    
        if (player-hide-desc-game) {
            ytd-video-description-gaming-section-renderer {
                display: none !important;
            }
        }
    
        if (player-hide-desc-music) {
            ytd-horizontal-card-list-renderer[has-subtitle=""] {
                display: none !important;
            }
        }

        if (player-hide-desc-reels) {
            ytd-reel-shelf-renderer {
                display: none !important;
            }
        }
    
        if (player-hide-desc-info-cards) {
            ytd-video-description-infocards-section-renderer {
                display: none !important;
            }
        }
        else {
            if (player-hide-desc-info-card-channel) {
                ytd-video-description-infocards-section-renderer #header {
                    display: none !important;
                }
            }

            if (player-hide-desc-info-card-social) {
                ytd-video-description-infocards-section-renderer #social-links {
                    display: none !important;
                }
            }

            if (player-hide-desc-info-card-videos) {
                ytd-video-description-infocards-section-renderer #infocards-section {
                    display: none !important;
                }
            }
        }
    }

    ytd-comment-thread-renderer {
        if (comments-hide-links) {
            &:has( > #comment-container > ytd-comment-view-model #content-text a[target="_blank"]) {
                display: none !important;
            }
        }

        ytd-comment-view-model {
            if (comments-hide-pinned) {
                :has(ytd-pinned-comment-badge-renderer) {
                    display: none !important;
                }
            }

            if (comments-hide-translate) {
                .translate-button {
                    display: none !important;
                }
            }
        }
    }
}